{% extends 'base.html' %}

{% block content %}
    <style>

        path {
            fill: #ccc;
            stroke: #fff;
            stroke-width: 1px;
        }

        circle {
            fill: #fff;
            fill-opacity: 0.4;
            stroke: #111;
        }

        path.active {
            fill: pink;
        }

        circle.active {
            fill: blue;
        }


    </style>
    <body>
    <script src="https://d3js.org/d3-array.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>

    <script>

        var width = 960,
            height = 500;

        var projection = d3.geoMercator();

        var path = d3.geoPath()
            .projection(projection);

        var svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height);

        var url = "http://dados.al.gov.br/dataset/5475461a-02d4-49fe-9a2e-03ec5a84eab6/resource/b60a483a-95c7-45a7-83d7-af965eba47e5/download/malha2015.geojson";
        d3.json(url, function (error, countries) {
            d3.json(url2, function (error, places) {
                if (error) console.log(error);

                svg.selectAll("path")
                    .data(countries.features)
                    .enter().append("path")
                    .attr("d", path)
                    .on("mouseover", function (d) {
                        console.log("just had a mouseover", d3.select(d));
                        d3.select(this)
                            .classed("active", true)
                    })
                    .on("mouseout", function (d) {
                        d3.select(this)
                            .classed("active", false)
                    });


                svg.selectAll("circle")
                    .data(places.features)
                    .enter().append("circle")
                    .attr('r', 5)
                    .attr('cx', function (d) {
                        return projection(d.geometry.coordinates)[0]
                    })
                    .attr('cy', function (d) {
                        return projection(d.geometry.coordinates)[1]
                    })
                    .on("mouseover", function (d) {
                        console.log("just had a mouseover", d3.select(d));
                        d3.select(this)
                            .classed("active", true)
                    })
                    .on("mouseout", function (d) {
                        d3.select(this)
                            .classed("active", false)
                    });

            });

        });

    </script>
{% endblock %}
